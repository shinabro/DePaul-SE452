<?xml version="1.0"?>
<project name="dataprep" basedir="." default="printData">
    <!-- HSQLDB -->
    <property name="db.driver" value="org.hsqldb.jdbcDriver"/>
    <property name="db.url" value="jdbc:hsqldb:file:db/mydb"/>
    <property name="db.user" value=""/>
    <property name="db.pw" value=""/>

    <path id="master-classpath">
        <fileset dir="../lib/">
            <include name="*.jar"/>
        </fileset>
    </path>

    <target name="createTables">
        <echo message="CREATE TABLES USING: ${db.driver} ${db.url}"/>
        <sql driver="${db.driver}"
             url="${db.url}"
             userid="${db.user}"
             password="${db.pw}"
             onerror="stop">
            <classpath refid="master-classpath"/>
            create table USERS(id INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 100) PRIMARY KEY, name
            varchar(50));
            create table CUSTOMER (ID integer GENERATED BY DEFAULT AS IDENTITY(START WITH 100) PRIMARY KEY, NAME
            VARCHAR(50));
            create table ORDER_TABLE (ORDER_ID integer GENERATED BY DEFAULT AS IDENTITY(START WITH 100) PRIMARY KEY,
            SHIPPING_ADDRESS VARCHAR(50), CUSTOMER_ID INTEGER, FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER (ID));
            COMMIT;
            SHUTDOWN;
        </sql>
        <!-- For MySQL use, id INTEGER NOT NULL PRIMARY KEY auto_increment, -->
        <!-- For HSQL use,  id INTEGER IDENTITY, -->
    </target>
    <target name="dropTables">
        <echo message="DROP TABLES USING: ${db.driver} ${db.url}"/>
        <sql driver="${db.driver}"
             url="${db.url}"
             userid="${db.user}"
             password="${db.pw}"
             onerror="continue">
            <classpath refid="master-classpath"/>
            DROP TABLE users;
            DROP TABLE customer;
            DROP TABLE order_table;
            COMMIT;
            SHUTDOWN
        </sql>
    </target>

    <target name="clearData">
        <echo message="REMOVING DATA USING: ${db.driver} ${db.url}"/>
        <sql driver="${db.driver}"
             url="${db.url}"
             userid="${db.user}"
             password="${db.pw}"
             onerror="continue">
            <classpath refid="master-classpath"/>
            DELETE FROM users
            COMMIT;
            SHUTDOWN
        </sql>
    </target>

    <target name="loadData" depends="clearData">
        <echo message="LOAD TABLES USING: ${db.driver} ${db.url}"/>
        <sql driver="${db.driver}"
             url="${db.url}"
             userid="${db.user}"
             password="${db.pw}"
             onerror="continue">
            <classpath refid="master-classpath"/>
            INSERT INTO users (name) values('Kid');
            INSERT INTO users (name) values('Rob');
            INSERT INTO users (name) values('Dave');
            COMMIT;
            SHUTDOWN
        </sql>
    </target>

    <target name="printData">
        <echo message="PRINT TABLES USING: ${db.driver} ${db.url}"/>
        <sql driver="${db.driver}"
             url="${db.url}"
             userid="${db.user}"
             password="${db.pw}"
             onerror="continue"
             print="true">
            <classpath refid="master-classpath"/>

            SELECT * FROM users;
            SHUTDOWN
        </sql>
    </target>

</project>